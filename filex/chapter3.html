<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="description" content="This chapter contains a description of the high-performance FileX embedded file system from a functional perspective.">
<title>Chapter 3 - Functional components of FileX</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Chapter 3 - Functional components of FileX</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This chapter contains a description of the high-performance FileX embedded file system from a functional perspective.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_media_description">Media Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>FileX is a high-performance embedded file system that conforms to the FAT file system format. FileX views the physical media as an array of logical sectors. How these sectors are mapped to the underlying physical media is determined by the I/O driver connected to the FileX media during the <strong><em>fx_media_open</em></strong> call.</p>
</div>
<div class="sect2">
<h3 id="_fat121632_logical_sectors">FAT12/16/32 Logical Sectors</h3>
<div class="paragraph">
<p>The exact organization of the media&#8217;s logical sectors is determined by the contents of the physical media&#8217;s boot record. The general layout of the media&#8217;s logical sectors is shown in Figure 1.</p>
</div>
<div class="paragraph">
<p>FileX logical sectors start at logical sector 1, which points to the first reserved sector of the media. Reserved sectors are optional, but when in use they typically contain system information such as boot code.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fat121632_media_boot_record">FAT12/16/32 Media Boot Record</h3>
<div class="paragraph">
<p>The exact sector offset of the other areas in the logical sector view of the media is derived from the contents of the <em>media boot record</em>. The location of the boot record is typically at sector 0. However, if the media has <em>hidden sectors</em>, the offset to the boot sector must account for them (they are located immediately BEFORE the boot sector). Table 1 lists the media&#8217;s boot record components, and the components are described in the paragraphs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Jump Instruction</strong> The <em>jump instruction</em> field is a three-byte field that represents an Intel x86 machine instruction for a processor jump. This is a legacy field in most situations.</p>
<div class="imageblock">
<div class="content">
<img src="./media/user-guide/filex-media-logical-sector-view.png" alt="FileX Media Logical Sector View">
</div>
</div>
<div class="paragraph">
<p><strong>FIGURE 1. FileX Media Logical Sector View</strong></p>
</div>
</li>
<li>
<p><strong>OEM Name</strong> The <em>OEM name</em> field is reserved for manufacturers to place their name or a name for the device.</p>
</li>
<li>
<p><strong>Bytes Per Sector</strong> The <em>bytes per sector</em> field in the media boot record defines how many bytes are in each sector&#8212;&#8203;the fundamental element of the media.</p>
</li>
<li>
<p><strong>Sectors Per Cluster</strong> The <em>sectors per cluster</em> field in the media boot record defines the number of sectors assigned to a cluster. The cluster is the fundamental allocation element in an FAT compatible file system. All file information and subdirectories are allocated from the media&#8217;s available clusters as determined by the File Allocation Table (FAT).</p>
<div class="paragraph">
<p><strong>TABLE 1. FileX Media Boot Record</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Offset</th>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Number of Bytes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jump Instruction (e9,xx,xx or eb,xx,90)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x03</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OEM Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bytes Per Sector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sectors Per Cluster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of Reserved Sectors</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of FATs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of Root Directory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of Sectors FAT-12 &amp; FAT-16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Media Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of Sectors Per FAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sectors Per Track</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of Heads</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of Hidden Sectors</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of Sectors - FAT-32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sectors per FAT (FAT-32)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x2C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Root Directory Cluster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x3E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">System Boot code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">448</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1FE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x55AA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Reserved Sectors</strong> The <em>reserved sectors</em> field in the media boot record defines the number of sectors reserved between the boot record and the first sector of the FAT area. This entry is zero in most cases.</p>
</li>
<li>
<p><strong>Number of FATs</strong> The <em>number of FATs</em> entry in the media boot record defines the number of FATs in the media. There must always be at least one FAT in a media. Additional FATs are merely duplicate copies of the primary (first) FAT and are typically used by diagnostic or recovery software.</p>
</li>
<li>
<p><strong>Root Directory Size</strong> The <em>root directory size</em> entry in the media boot record defines the fixed number of entries in the root directory of the media. This field is not applicable to subdirectories and the FAT-32 root directory because they are both allocated from the media&#8217;s clusters.</p>
</li>
<li>
<p><strong>Number of Sectors FAT-12 &amp; FAT-16</strong> The <em>number of sectors</em> field in the media boot record contains the total number of sectors in the media. If this field is zero, then the total number of sectors is contained in the <em>number of sectors FAT-32</em> field located later in the boot record.</p>
</li>
<li>
<p><strong>Media Type</strong> The <em>media type</em> field is used to identify the type of media present to the device driver. This is a legacy field.</p>
</li>
<li>
<p><strong>Sectors Per FAT</strong> The <em>sectors per FAT</em> filed in the media boot record contains the number of sectors associated with each FAT in the FAT area. The number of FAT sectors must be large enough to account for the maximum possible number of clusters that can be allocated in the media.</p>
</li>
<li>
<p><strong>Sectors Per Track</strong> The <em>sectors per track</em> field in the media boot record defines the number of sectors per track. This is typically only pertinent to actual disk-type media. FLASH devices don&#8217;t use this mapping.</p>
</li>
<li>
<p><strong>Number of Heads</strong> The <em>number of heads</em> field in the media boot record defines the number of heads in the media. This is typically only pertinent to actual disk-type media. FLASH devices don&#8217;t use this mapping.</p>
</li>
<li>
<p><strong>Hidden Sectors</strong> The <em>hidden sectors</em> field in the media boot record defines the number of sectors before the boot record. This field is maintained in the <strong>FX_MEDIA</strong> control block and must be accounted for in FileX I/O drivers in all read and write requests made by FileX.</p>
</li>
<li>
<p><strong>Number of Sectors FAT-32</strong> The <em>number of sectors</em> field in the media boot record is valid only if the two-byte <em>number of sectors</em> field is zero. In such a case, this four-byte field contains the number of sectors in the media.</p>
</li>
<li>
<p><strong>Sectors per FAT (FAT-32)</strong> The <em>sectors per FAT (FAT-32)</em> field is valid only in FAT-32 format and contains the number of sectors allocated for each FAT of the media.</p>
</li>
<li>
<p><strong>Root Directory Cluster</strong> The <em>root directory cluster</em> field is valid only in FAT-32 format and contains the starting cluster number of the root directory.</p>
</li>
<li>
<p><strong>System Boot Code</strong> The <em>system boot code</em> field is an area to store a small portion of boot code. In most devices today, this is a legacy field.</p>
</li>
<li>
<p><strong>Signature 0x55AA</strong> The <em>signature</em> field is a data pattern used to identify the boot record. If this field is not present, the boot record is not valid.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_file_allocation_table_fat">File Allocation Table (FAT)</h3>
<div class="paragraph">
<p>The <em>File Allocation Table (FAT)</em> starts after the reserved sectors in the media. The FAT area is basically an array of 12-bit, 16-bit, or 32-bit entries that determine if that cluster is allocated or part of a chain of clusters comprising a subdirectory or a file. The size of each FAT entry is determined by the number of clusters that need to be represented. If the number of clusters (derived from the total sectors divided by the sectors per cluster) is less than or equal to 4,086, 12-bit FAT entries are used. If the total number of clusters is greater than 4,086 and less than 65,525, 16-bit FAT entries are used. Otherwise, if the total number of clusters is greater than or equal to 65,525, 32-bit FAT is used.</p>
</div>
<div class="paragraph">
<p>For FAT12/16/32, the FAT table not only maintains the cluster chain, it also provides information on cluster allocation: whether or not a cluster is available.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fat_entry_contents">FAT Entry Contents</h3>
<div class="paragraph">
<p>The first two entries in the FAT table are not used and typically have the following contents.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">FAT Entry</th>
<th class="tableblock halign-left valign-top">12-bit FAT</th>
<th class="tableblock halign-left valign-top">16-bit FAT</th>
<th class="tableblock halign-left valign-top">32-bit FAT</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entry 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0F0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x00F0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x000000F0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entry 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFFF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFFFF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0FFFFFFF</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>FAT entry number 2 represents the first cluster in the media&#8217;s data area. The contents of each cluster entry determines whether or not it is free or part of a linked list of clusters allocated for a file or a subdirectory. If the cluster entry contains another valid cluster entry, then the cluster is allocated and its value points to the next cluster allocated in the cluster chain.</p>
</div>
<div class="paragraph">
<p>Possible cluster entries are defined as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">12-bit FAT</th>
<th class="tableblock halign-left valign-top">16-bit FAT</th>
<th class="tableblock halign-left valign-top">32-bit FAT</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Cluster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x00000000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not Used</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x00000001</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFF0-FF6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFFF0-FFF6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0FFFFFF0-6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bad Cluster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFF7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFFF7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0FFFFFF7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Last Cluster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFF8-FFF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFFF8-FFFF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0FFFFFF8-F</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cluster Link</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x002-0xFEF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0002-FFEF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x2-0x0FFFFFEF</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The last cluster in an allocated chain of clusters contains the Last Cluster value (defined above). The first cluster number is found in the file or subdirectory&#8217;s directory entry.</p>
</div>
</div>
<div class="sect2">
<h3 id="_internal_logical_cache">Internal Logical Cache</h3>
<div class="paragraph">
<p>FileX maintains a <em>most-recently-used</em> logical sector cache for each opened media. The maximum size of the logical sector cache is defined by the constant <strong>FX_MAX_SECTOR_CACHE</strong> and is located in <strong><em>fx_api.h</em></strong>. This is the first factor determining the size of the internal logical sector cache.</p>
</div>
<div class="paragraph">
<p>The other factor that determines the size of the logical sector cache is the amount of memory supplied to the <strong><em>fx_media_open</em></strong> call by the application. There must be enough memory for at least one logical sector. If more than <strong>FX_MAX_SECTOR_CACHE</strong> logical sectors are required, the constant must be changed in <strong><em>fx_api.h</em></strong> and the entire FileX library must be rebuilt.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<em>Each opened media in FileX may have a different cache size depending on the memory supplied during the open call.</em>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_write_protect">Write Protect</h3>
<div class="paragraph">
<p>FileX provides the application driver the ability to dynamically set write protection on the media. If write protection is required, the driver sets to FX_TRUE the <em>fx_media_driver_write_protect</em> field in the associated FX_MEDIA structure. When set, all attempts by the application to modify the media are rejected as well as attempts to open files for writing. The driver may also disable write protection by clearing this field.</p>
</div>
</div>
<div class="sect2">
<h3 id="_free_sector_update">Free Sector Update</h3>
<div class="paragraph">
<p>FileX provides a mechanism to inform the application driver when sectors are no longer in use. This is especially useful for FLASH memory managers that manage all logical sectors being used by FileX.</p>
</div>
<div class="paragraph">
<p>If notification of free sectors is required, the application driver sets to FX_TRUE the <em>fx_media_driver_free_sector_update</em> field in the associated FX_MEDIA structure. This assignment is typically done during driver initialization.</p>
</div>
<div class="paragraph">
<p>Setting this field, FileX makes a <strong>FX_DRIVER_RELEASE_SECTORS</strong> driver call indicating when one or more consecutive sectors become free.</p>
</div>
</div>
<div class="sect2">
<h3 id="_media_control_block_fx_media">Media Control Block FX_MEDIA</h3>
<div class="paragraph">
<p>The characteristics of each open media in FileX are contained in the media control block. This structure is defined in the file <strong><em>fx_api.h</em></strong>.</p>
</div>
<div class="paragraph">
<p>The media control block can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</p>
</div>
<div class="paragraph">
<p>Locating the control block in other areas requires a bit more care, just like all dynamically allocated memory. If a control block is allocated within a C function, the memory associated with it is part of the calling thread&#8217;s stack.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>[!WARNING]
<em>In general, avoid using local storage for control blocks because after the function returns, all of its local variable stack space is released&#8212;&#8203;regardless of whether it is still in use!</em></p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fat121632_directory_description"><strong>FAT12/16/32 Directory Description</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>FileX supports both 8.3 and Windows Long File Name (LFN) name formats. In addition to the name, each directory entry contains the entry&#8217;s attributes, the last modified time and date, the starting cluster index, and the size in bytes of the entry. Table 3 shows the contents and size of a FileX 8.3 directory entry.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Directory Name</strong></p>
<div class="paragraph">
<p>FileX supports file names ranging in size from 1 to 255 characters. Standard eight-character file names are represented in a single directory entry on the media. They are left justified in the directory name field and are blank padded. In addition, the ASCII characters that comprise the name are always capitalized.</p>
</div>
<div class="paragraph">
<p>Long File Names (LFNs) are represented by consecutive directory entries, in reverse order, followed immediately by an 8.3 standard file name. The created 8.3 name contains all the meaningful directory information associated with the name. Table 4 shows the contents of the directory entries used to hold the Long File Name information, and Table 5 shows an example of a 39-character LFN that requires a total of four directory entries.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<em>The constant <strong>FX_MAX_LONG_NAME_LEN</strong>, defined in <strong>fx_api.h</strong>, contains the maximum length supported by FileX.</em>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>Directory Filename Extension</strong></p>
<div class="paragraph">
<p>For standard 8.3 file names, FileX also supports the optional three-character <em>directory filename extension</em>. Just like the eight-character file name, filename extensions are left justified in the directory filename extension field, blank padded, and always capitalized.</p>
</div>
<div class="paragraph">
<p><strong>TABLE 3. FileX 8.3 Directory Entry</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Offset</th>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Number of Bytes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory Entry Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x08</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory Extension</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attributes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NT (introduced by the long file name format and is reserved for NT [always 0])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Created Time in milliseconds ( introduced by the long file name format and represents the number of milliseconds when the file was created.)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Created Time in hours &amp; minutes (introduced by the long file name format and represents the hour and minute the file was created )</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Created Date (introduced by the long file name format and represents the date the file was created.)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Last Accessed Date ( introduced by the long file name format and represents the date the file was last accessed.)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starting Cluster (Upper 16 bits FAT-32 only)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modified Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modified Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starting Cluster (Lower 16 bits FAT-32 or FAT-12 or FAT-16)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File Size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Directory Attributes</strong></p>
<div class="paragraph">
<p>The one-byte <em>directory attribute</em> field entry contains a series of bits that specify various properties of the directory entry. Directory attribute definitions are as follow:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute Bit</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entry is read-only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entry is hidden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x04</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entry is a system entry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x08</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entry is a volume label</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entry is a directory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entry has been modified.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Because all the attribute bits are mutually exclusive, there may be more than one attribute bit set at a time.</p>
</div>
</li>
<li>
<p><strong>Directory Time</strong></p>
<div class="paragraph">
<p>The two-byte <em>directory time</em> field contains the hours, minutes, and seconds of the last change to the specified directory entry. Bits 15 through 11 contain the hours, bits 10 through 5 contain the minutes, and bits 4 through 0 contain the half seconds. Actual seconds are divided by two before being written into this field.</p>
</div>
</li>
<li>
<p><strong>Directory Date</strong></p>
<div class="paragraph">
<p>The two-byte <em>directory date</em> field contains the year (offset from 1980), month, and day of the last change to the specified directory entry. Bits 15 through 9 contain the year offset, bits 8 through 5 contain the month offset, and bits 4 through 0 contain the day.</p>
</div>
</li>
<li>
<p><strong>Directory Starting Cluster</strong></p>
<div class="paragraph">
<p>This field occupies 2 bytes for FAT-12 and FAT-16. For FAT-32 this field occupies 4 bytes. This field contains the first cluster number allocated to the entry (subdirectory or file).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
*Note that FileX creates new files without an initial cluster (starting cluster field equal to zero) to allow users to optionally allocate a contiguous number of clusters for a newly created file. *
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>Directory File Size</strong></p>
<div class="paragraph">
<p>The four-byte <em>directory</em> <em>file size</em> field contains the number of bytes in the file. If the entry is really a subdirectory, the size field is zero.</p>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_long_file_name_directory">Long File Name Directory</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Ordinal</strong></p>
<div class="paragraph">
<p>The one-byte <em>ordinal</em> field that specifies the number of the LFN entry. Because LFN entries are positioned in reverse order, the ordinal values of the LFN directory entries comprising a single LFN decrease by one. In addition, the ordinal value of the LFN directly before the 8.3 file name must be one.</p>
</div>
<div class="paragraph">
<p><strong>TABLE 4. Long File Name Directory Entry</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Offset</th>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Number of Bytes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ordinal Field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x03</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x05</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x07</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x09</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LFN Attributes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LFN Type (Reserved always 0)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LFN Checksum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LFN Cluster (unused always 0)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode Character 13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Unicode Character</strong></p>
<div class="paragraph">
<p>The two-byte <em>Unicode Character</em> fields are designed to support characters from many different languages. Standard ASCII characters are represented with the ASCII character stored in the first byte of the Unicode character followed by a space character.</p>
</div>
</li>
<li>
<p><strong>LFN Attributes</strong></p>
<div class="paragraph">
<p>The one-byte <em>LFN Attributes</em> field contains attributes that identify the directory entry as an LFN directory entry. This is accomplished by having the read-only, system, hidden, and volume attributes all set.</p>
</div>
</li>
<li>
<p><strong>LFN Type</strong></p>
<div class="paragraph">
<p>The one-byte <em>LFN Type</em> field is reserved and is always 0.</p>
</div>
</li>
<li>
<p><strong>LFN Checksum</strong></p>
<div class="paragraph">
<p>The one-byte <em>LFN Checksum</em>
field represents a checksum of the 11 characters of the associated MSDOS 8.3 file name. This checksum is stored in each LFN entry to help ensure the LFN entry corresponds to the appropriate 8.3 file name.</p>
</div>
</li>
<li>
<p><strong>LFN Cluster</strong></p>
<div class="paragraph">
<p>The two-byte <em>LFN Cluster</em> field is unused and is always 0.</p>
</div>
<div class="paragraph">
<p><strong>TABLE 5. Directory Entries Comprising a 39-Character LFN</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Entry</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LFN Directory Entry 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LFN Directory Entry 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LFN Directory Entry 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8.3 Directory Entry (ttttt~n.xx)</p></td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_notes_on_timestamps">Notes on Timestamps</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Timestamp Entry</strong>
The timestamp fields are interpreted as follows:</p>
</li>
<li>
<p><strong>10ms Increment Fields</strong>
The value in the 10ms increment field provides finer granularity to the timestamp value. The valid values are between 0 (0ms) and 199 (1990ms).</p>
<div class="imageblock">
<div class="content">
<img src="./media/user-guide/10ms-increment-fields.png" alt="10ms Increment Fields">
</div>
</div>
</li>
<li>
<p><strong>UTC Offset Field</strong></p>
<div class="imageblock">
<div class="content">
<img src="./media/user-guide/utc-offset-field.png" alt="UTC Offset Field">
</div>
</div>
</li>
<li>
<p><strong>Offset Value</strong></p>
<div class="paragraph">
<p>7-bit signed integer represents offset from UTC time, in 15 minutes increments.</p>
</div>
</li>
<li>
<p><strong>Valid</strong></p>
<div class="paragraph">
<p>Whether or not the value in the offset field is valid. 0 indicates the value in the offset value field is invalid. 1 indicates the value is valid.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_stream_extension_directory_entry">Stream Extension Directory Entry</h3>
<div class="paragraph">
<p>A description of Stream Extension Directory Entry and its contents is included in the following table.</p>
</div>
<div class="paragraph">
<p><strong>TABLE 7. Stream Extension Directory Entry</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Offset</th>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Number of Bytes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Entry Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flags</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x03</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name Length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x04</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name Hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x06</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x08</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Valid Data Length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved 3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First Cluster</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><strong>Entry Type</strong></p>
<div class="paragraph">
<p>The <em>entry type</em> field indicates the type of this entry. For streaming extension Directory Entry, this field must be 0xC0.</p>
</div>
</li>
<li>
<p><strong>Flags</strong></p>
<div class="paragraph">
<p>This field contains a series of bits that specify various properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flag Bit</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This field indicates whether or not allocation of clusters is possible. This field should be 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This field indicates whether or not the associated clusters are contiguous. A value 0 means the FAT entry is valid and FileX shall follow the FAT chain. A value 1 means the FAT entry is invalid and the clusters are contiguous.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">All other bits</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved.</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>Reserved 1</strong></p>
<div class="paragraph">
<p>This field should be 0.</p>
</div>
</li>
<li>
<p><strong>Name Length</strong></p>
<div class="paragraph">
<p>The <em>name length</em> field contains the length of the unicode string in the file name directory entries collectively contain. The file name directory entries shall immediately follow this stream extension directory entry.</p>
</div>
</li>
<li>
<p><strong>Name Hash</strong></p>
<div class="paragraph">
<p>The <em>name hash</em> field is a 2-byte entry, containing the hash value of the up-cased file name. The hash value allows faster file/directory name lookup: if the hash values don&#8217;t match, the file name associated with this entry is not a match.</p>
</div>
</li>
<li>
<p><strong>Reserved 2</strong></p>
<div class="paragraph">
<p>This field should be 0.</p>
</div>
</li>
<li>
<p><strong>Valid Data Length</strong></p>
<div class="paragraph">
<p>The <em>valid data length</em> field indicates the amount of valid data in the file.</p>
</div>
</li>
<li>
<p><strong>Reserved 3</strong></p>
<div class="paragraph">
<p>This filed should be 0.</p>
</div>
</li>
<li>
<p><strong>First Cluster</strong></p>
<div class="paragraph">
<p>The <em>first cluster</em> field contains index of the first cluster of the data stream.</p>
</div>
</li>
<li>
<p><strong>Data Length</strong></p>
<div class="paragraph">
<p>The <em>data length</em> field contains the total number of bytes in the allocated clusters.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_root_directory">Root Directory</h3>
<div class="paragraph">
<p>In FAT 12- and 16-bit formats, the <em>root directory</em> is located immediately after all the FAT sectors in the media and can be located by examining the <strong><em>fx_media_root_sector_start</em></strong> in an opened <strong>FX_MEDIA</strong> control block. The size of the root directory, in terms of number of directory entries (each 32 bytes in size), is determined by the corresponding entry in the media&#8217;s boot record.</p>
</div>
<div class="paragraph">
<p>The root directory in FAT-32 can be located anywhere in the available clusters. Its location and size are determined from the boot record when the media is opened. After the media is opened, the <strong><em>fx_media_root_sector_start</em></strong> field can be used to find the starting cluster of the FAT-32 root directory.</p>
</div>
</div>
<div class="sect2">
<h3 id="_subdirectories">Subdirectories</h3>
<div class="paragraph">
<p>There is any number of subdirectories in an FAT system. The name of the subdirectory resides in a directory entry just like a file name. However, the directory attribute specification (0x10) is set to indicate the entry is a subdirectory and the file size is always zero.
Figure 3 shows what a typical subdirectory structure looks like for a new singlecluster subdirectory named <strong><em>SAMPLE.DIR</em></strong> with one file called <strong><em>FILE.TXT</em></strong>.
In most ways, subdirectories are very similar to file entries. The first cluster field points to the first cluster of a linked list of clusters. When a subdirectory is created, the first two directory entries contain default directories, namely the "." directory and the ".." directory. The "." directory points to the subdirectory itself, while the ".." directory points to the previous or parent directory.</p>
</div>
</div>
<div class="sect2">
<h3 id="_global_default_path">Global Default Path</h3>
<div class="paragraph">
<p>FileX provides a global default path for the media. The default path is used in any file or directory service that does not explicitly specify a full path.</p>
</div>
<div class="paragraph">
<p>Initially, the global default directory is set to the media&#8217;s root directory. This may be changed by the application by calling <strong><em>fx_directory_default_set</em></strong>.</p>
</div>
<div class="paragraph">
<p>The current default path for the media may be examined by calling <strong><em>fx_directory_default_get</em></strong>. This routine provides a string pointer to the default path string maintained inside of the <strong>FX_MEDIA</strong> control block.</p>
</div>
</div>
<div class="sect2">
<h3 id="_local_default_path">Local Default Path</h3>
<div class="paragraph">
<p>FileX also provides a thread-specific default path that allows different threads to have unique paths without conflict. The <strong>FX_LOCAL_PATH</strong> structure is supplied  by the application during calls to <strong><em>fx_directory_local_path_set</em></strong> and <strong><em>fx_directory_local_path_restore</em></strong> to modify the local path for the calling thread.</p>
</div>
<div class="paragraph">
<p>If a local path is present, the local path takes precedence over the global default media path. If the local path is not setup or if it is cleared with the <strong><em>fx_directory_local_path_clear</em></strong> service, the media&#8217;s global default path is used once again.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_file_description">File Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>FileX supports standard 8.3 character and long file names with three-character extensions. In addition to the ASCII name, each file entry contains the entry&#8217;s attributes, the last modified time and date, the starting cluster index, and the size in bytes of the entry.</p>
</div>
<div class="sect2">
<h3 id="_file_allocation">File Allocation</h3>
<div class="paragraph">
<p>FileX supports the standard cluster allocation scheme of the FAT format. In addition, FileX supports pre-cluster allocation of contiguous clusters. To accommodate this, each FileX file is created with no allocated clusters. Clusters are allocated on subsequent write requests or on <strong><em>fx_file_allocate</em></strong> requests to pre-allocate contiguous clusters.</p>
</div>
<div class="paragraph">
<p>Figure 4, "FileX FAT-16 File Example," shows a file named <strong><em>FILE.TXT</em></strong> with two sequential clusters allocated starting at cluster 101, a size of 26, and the alphabet as the data in the file&#8217;s first data cluster number 101.</p>
</div>
</div>
<div class="sect2">
<h3 id="_file_access">File Access</h3>
<div class="paragraph">
<p>A FileX file may be opened multiple times simultaneously for read access. However, a file can only be opened once for writing. The information used to support the file access is contained in the <strong><em>FX_FILE</em></strong> file control block.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<em>Note that the media driver can dynamically set write protection. If this happens all write requests are rejected as well as attempts to open a file for writing.</em>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_system_information">System Information</h2>
<div class="sectionbody">
<div class="paragraph">
<p>FileX system information consists of keeping track of the open media instances and maintaining the global system time and date.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./media/user-guide/system-information.png" alt="File with Contiguous Clusters vs. File Requiring FAT Link">
</div>
</div>
<div class="paragraph">
<p><strong>FIGURE 3. File with Contiguous Clusters vs. File Requiring FAT Link</strong></p>
</div>
<div class="paragraph">
<p>By default, the system date and time are set to the last release date of FileX. To have accurate system date and time, the application must call <strong><em>fx_system_time_set</em></strong> and <strong><em>fx_system_date_set</em></strong> during initialization.</p>
</div>
<div class="sect2">
<h3 id="_system_date">System Date</h3>
<div class="paragraph">
<p>The FileX system date is maintained in the global <strong><em>_fx_system_date</em></strong> variable. Bits 15 through 9 contain the year offset from 1980, bits 8 through 5 contain the month offset, and bits 4 through 0 contain the day.</p>
</div>
</div>
<div class="sect2">
<h3 id="_system_time">System Time</h3>
<div class="paragraph">
<p>The FileX system time is maintained in the global <strong><em>_fx_system_time</em></strong> variable. Bits 15 through 11 contain the hours, bits 10 through 5 contain the minutes, and bits 4 through 0 contain the half seconds.</p>
</div>
</div>
<div class="sect2">
<h3 id="_periodic_time_update">Periodic Time Update</h3>
<div class="paragraph">
<p>During system initialization, FileX creates a ThreadX application timer to periodically update the system date and time. The rate at which the system date and time update is determined by two constants used by the <strong><em>_fx_system_initialize</em></strong> function.</p>
</div>
<div class="paragraph">
<p>The constants <strong>FX_UPDATE_RATE_IN_SECONDS</strong> and <strong>FX_UPDATE_RATE_IN_TICKS</strong> represent the same period of time. The constant <strong>FX_UPDATE_RATE_IN_TICKS</strong> is the number of ThreadX timer ticks that represents the number of seconds specified by the constant <strong>FX_UPDATE_RATE_IN_SECONDS</strong>. The <strong>FX_UPDATE_RATE_IN_SECONDS</strong> constant specifies how many seconds between each FileX time update. Therefore, the internal FileX time increments in intervals of <strong>FX_UPDATE_RATE_IN_SECONDS</strong>. These constants may be supplied during compilation of <strong><em>fx_system_initialize</em></strong>, or the developer may modify the defaults found in the <strong><em>fx_port.h</em></strong> file of the FileX release.</p>
</div>
<div class="paragraph">
<p>The periodic FileX timer is used only for updating the global system date and time, which is used solely for file time-stamping. If time-stamping is not necessary, simply define <strong>FX_NO_TIMER</strong> when compiling <strong><em>fx_system_initialize.c</em></strong> to eliminate the creation of the FileX periodic timer.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./media/user-guide/fat-16-file-example.png" alt="FileX FAT-16 File Example">
</div>
</div>
<div class="paragraph">
<p><strong>FIGURE 4. FileX FAT-16 File Example</strong></p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-02-07 07:46:26 UTC
</div>
</div>
</body>
</html>